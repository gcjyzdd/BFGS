//
// Author: Changjie Guan (changjieguan@gmail.com)
//
//
//BSD 2-Clause License
//
//Copyright (c) 2018, Changjie
//All rights reserved.
//
//Redistribution and use in source and binary forms, with or without
//modification, are permitted provided that the following conditions are met:
//
//* Redistributions of source code must retain the above copyright notice, this
//  list of conditions and the following disclaimer.
//
//* Redistributions in binary form must reproduce the above copyright notice,
//  this list of conditions and the following disclaimer in the documentation
//  and/or other materials provided with the distribution.
//
//THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
//AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
//IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
//DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
//FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
//DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
//SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
//CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
//OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
//OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
#include <iostream>
#include <chrono>
#include <vector>
#include <functional>
#include <math.h>

#include "phr.hpp"
#include "bfgs.hpp"

using namespace std;

namespace SISS {

	inline double Heaviside(double x) { return x > 0 ? 1 : 0; }
	const double pi = atan(1) * 4;

	struct LDM : public ConstraintObj
	{
		struct Settings
		{
			// system settings
			double dt;
			size_t N;
			size_t m, n;

			// car parameters
			double Lf, Lr, Caf, Car, Mass, I;

			// weights
			double w_cte, w_v, w_s, w_a, w_sd, w_ad, w_epsi;

			// boundaries
			double steer_max, steer_min, a_max, a_min;
		};

		struct Args
		{
			double ref_v, dt;
			double x, y, vx, vy, psi, r;
			vector<double> coeffs;

		};

		Settings settings;
		Args args;

		// constructor
		LDM()
		{
			settings.dt = 1.0 / 20;
			settings.N = 10;
			settings.m = 2;
			settings.n = 6;
			m_l = settings.n * settings.N;
			m_m = 4 * (settings.N - 1);
			m_n = settings.n*settings.N + settings.m*(settings.N - 1);

			settings.Lf = 1.17;
			settings.Lr = 1.77;
			settings.Mass = 1820.0;
			settings.I = 3746.0;
			settings.Caf = 72653.0;
			settings.Car = 121449.0;

			// Input boundaries
			settings.steer_max = 25 * pi / 180;
			settings.steer_min = -25 * pi / 180;
			settings.a_max = 3.75;
			settings.a_min = -10.0;

			// MPC weights
			settings.w_cte = 300.0;
			settings.w_s = 1;
			settings.w_sd = 1;
			settings.w_a = 1;
			settings.w_ad = 10;
			settings.w_v = 1;
			settings.w_epsi = 20;

			// Initial state
			args.ref_v = 40 / 3.6;
			args.coeffs = { -1, 0, 0.001, 0 };

			args.x = -1;
			args.y = 1;
			args.vx = 10;
			args.vy = 0;
			args.psi = 0;
			args.r = 0;

			m_x.resize(settings.n*settings.N + settings.m*(settings.N - 1));
			m_x.fill(0.);
		}

		double cost(VectorXd const &x)
		{
			double p0 = args.coeffs[0];
			double p1 = args.coeffs[1];
			double p2 = args.coeffs[2];
			double p3 = args.coeffs[3];

			double ref_v = args.ref_v;

			double w_cte = settings.w_cte;
			double w_v = settings.w_v;
			double w_s = settings.w_s;
			double w_a = settings.w_a;
			double w_sd = settings.w_sd;
			double w_ad = settings.w_ad;
			double w_ep = settings.w_epsi;

			double c = w_a * pow(x[69], 2) + w_a * pow(x[70], 2) + w_a * pow(x[71], 2) + w_a * pow(x[72], 2) + w_a * pow(x[73], 2) + w_a * pow(x[74], 2) + w_a * pow(x[75], 2) + w_a * pow(x[76], 2) + w_a * pow(x[77], 2) + w_ad * pow(-x[69] + x[70], 2) + w_ad * pow(-x[70] + x[71], 2) + w_ad * pow(-x[71] + x[72], 2) + w_ad * pow(-x[72] + x[73], 2) + w_ad * pow(-x[73] + x[74], 2) + w_ad * pow(-x[74] + x[75], 2) + w_ad * pow(-x[75] + x[76], 2) + w_ad * pow(-x[76] + x[77], 2) + w_cte * pow(p0 + p1 * x[0] + p2 * pow(x[0], 2) + p3 * pow(x[0], 3) - x[10], 2) + w_cte * pow(p0 + p1 * x[1] + p2 * pow(x[1], 2) + p3 * pow(x[1], 3) - x[11], 2) + w_cte * pow(p0 + p1 * x[2] + p2 * pow(x[2], 2) + p3 * pow(x[2], 3) - x[12], 2) + w_cte * pow(p0 + p1 * x[3] + p2 * pow(x[3], 2) + p3 * pow(x[3], 3) - x[13], 2) + w_cte * pow(p0 + p1 * x[4] + p2 * pow(x[4], 2) + p3 * pow(x[4], 3) - x[14], 2) + w_cte * pow(p0 + p1 * x[5] + p2 * pow(x[5], 2) + p3 * pow(x[5], 3) - x[15], 2) + w_cte * pow(p0 + p1 * x[6] + p2 * pow(x[6], 2) + p3 * pow(x[6], 3) - x[16], 2) + w_cte * pow(p0 + p1 * x[7] + p2 * pow(x[7], 2) + p3 * pow(x[7], 3) - x[17], 2) + w_cte * pow(p0 + p1 * x[8] + p2 * pow(x[8], 2) + p3 * pow(x[8], 3) - x[18], 2) + w_cte * pow(p0 + p1 * x[9] + p2 * pow(x[9], 2) + p3 * pow(x[9], 3) - x[19], 2) + w_ep * pow(x[50] - atan(p1 + 2 * p2*x[0] + 3 * p3*x[0]), 2) + w_ep * pow(x[51] - atan(p1 + 2 * p2*x[1] + 3 * p3*x[1]), 2) + w_ep * pow(x[52] - atan(p1 + 2 * p2*x[2] + 3 * p3*x[2]), 2) + w_ep * pow(x[53] - atan(p1 + 2 * p2*x[3] + 3 * p3*x[3]), 2) + w_ep * pow(x[54] - atan(p1 + 2 * p2*x[4] + 3 * p3*x[4]), 2) + w_ep * pow(x[55] - atan(p1 + 2 * p2*x[5] + 3 * p3*x[5]), 2) + w_ep * pow(x[56] - atan(p1 + 2 * p2*x[6] + 3 * p3*x[6]), 2) + w_ep * pow(x[57] - atan(p1 + 2 * p2*x[7] + 3 * p3*x[7]), 2) + w_ep * pow(x[58] - atan(p1 + 2 * p2*x[8] + 3 * p3*x[8]), 2) + w_ep * pow(x[59] - atan(p1 + 2 * p2*x[9] + 3 * p3*x[9]), 2) + w_s * pow(x[60], 2) + w_s * pow(x[61], 2) + w_s * pow(x[62], 2) + w_s * pow(x[63], 2) + w_s * pow(x[64], 2) + w_s * pow(x[65], 2) + w_s * pow(x[66], 2) + w_s * pow(x[67], 2) + w_s * pow(x[68], 2) + w_sd * pow(-x[60] + x[61], 2) + w_sd * pow(-x[61] + x[62], 2) + w_sd * pow(-x[62] + x[63], 2) + w_sd * pow(-x[63] + x[64], 2) + w_sd * pow(-x[64] + x[65], 2) + w_sd * pow(-x[65] + x[66], 2) + w_sd * pow(-x[66] + x[67], 2) + w_sd * pow(-x[67] + x[68], 2) + w_v * pow(ref_v - x[20], 2) + w_v * pow(ref_v - x[21], 2) + w_v * pow(ref_v - x[22], 2) + w_v * pow(ref_v - x[23], 2) + w_v * pow(ref_v - x[24], 2) + w_v * pow(ref_v - x[25], 2) + w_v * pow(ref_v - x[26], 2) + w_v * pow(ref_v - x[27], 2) + w_v * pow(ref_v - x[28], 2) + w_v * pow(ref_v - x[29], 2);

			return c;
		}

		void grad(VectorXd &diff, VectorXd &x)
		{
			diff.resize(x.size());
			double p0 = args.coeffs[0];
			double p1 = args.coeffs[1];
			double p2 = args.coeffs[2];
			double p3 = args.coeffs[3];

			double ref_v = args.ref_v;

			double w_cte = settings.w_cte;
			double w_v = settings.w_v;
			double w_s = settings.w_s;
			double w_a = settings.w_a;
			double w_sd = settings.w_sd;
			double w_ad = settings.w_ad;
			double w_ep = settings.w_epsi;

			diff << w_cte * (2 * p1 + 4 * p2*x[0] + 6 * p3*pow(x[0], 2))*(p0 + p1 * x[0] + p2 * pow(x[0], 2) + p3 * pow(x[0], 3) - x[10]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[50] - atan(p1 + 2 * p2*x[0] + 3 * p3*x[0])) / (pow(p1 + 2 * p2*x[0] + 3 * p3*x[0], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[1] + 6 * p3*pow(x[1], 2))*(p0 + p1 * x[1] + p2 * pow(x[1], 2) + p3 * pow(x[1], 3) - x[11]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[51] - atan(p1 + 2 * p2*x[1] + 3 * p3*x[1])) / (pow(p1 + 2 * p2*x[1] + 3 * p3*x[1], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[2] + 6 * p3*pow(x[2], 2))*(p0 + p1 * x[2] + p2 * pow(x[2], 2) + p3 * pow(x[2], 3) - x[12]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[52] - atan(p1 + 2 * p2*x[2] + 3 * p3*x[2])) / (pow(p1 + 2 * p2*x[2] + 3 * p3*x[2], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[3] + 6 * p3*pow(x[3], 2))*(p0 + p1 * x[3] + p2 * pow(x[3], 2) + p3 * pow(x[3], 3) - x[13]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[53] - atan(p1 + 2 * p2*x[3] + 3 * p3*x[3])) / (pow(p1 + 2 * p2*x[3] + 3 * p3*x[3], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[4] + 6 * p3*pow(x[4], 2))*(p0 + p1 * x[4] + p2 * pow(x[4], 2) + p3 * pow(x[4], 3) - x[14]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[54] - atan(p1 + 2 * p2*x[4] + 3 * p3*x[4])) / (pow(p1 + 2 * p2*x[4] + 3 * p3*x[4], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[5] + 6 * p3*pow(x[5], 2))*(p0 + p1 * x[5] + p2 * pow(x[5], 2) + p3 * pow(x[5], 3) - x[15]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[55] - atan(p1 + 2 * p2*x[5] + 3 * p3*x[5])) / (pow(p1 + 2 * p2*x[5] + 3 * p3*x[5], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[6] + 6 * p3*pow(x[6], 2))*(p0 + p1 * x[6] + p2 * pow(x[6], 2) + p3 * pow(x[6], 3) - x[16]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[56] - atan(p1 + 2 * p2*x[6] + 3 * p3*x[6])) / (pow(p1 + 2 * p2*x[6] + 3 * p3*x[6], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[7] + 6 * p3*pow(x[7], 2))*(p0 + p1 * x[7] + p2 * pow(x[7], 2) + p3 * pow(x[7], 3) - x[17]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[57] - atan(p1 + 2 * p2*x[7] + 3 * p3*x[7])) / (pow(p1 + 2 * p2*x[7] + 3 * p3*x[7], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[8] + 6 * p3*pow(x[8], 2))*(p0 + p1 * x[8] + p2 * pow(x[8], 2) + p3 * pow(x[8], 3) - x[18]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[58] - atan(p1 + 2 * p2*x[8] + 3 * p3*x[8])) / (pow(p1 + 2 * p2*x[8] + 3 * p3*x[8], 2) + 1), w_cte*(2 * p1 + 4 * p2*x[9] + 6 * p3*pow(x[9], 2))*(p0 + p1 * x[9] + p2 * pow(x[9], 2) + p3 * pow(x[9], 3) - x[19]) - 2 * w_ep*(2 * p2 + 3 * p3)*(x[59] - atan(p1 + 2 * p2*x[9] + 3 * p3*x[9])) / (pow(p1 + 2 * p2*x[9] + 3 * p3*x[9], 2) + 1), w_cte*(-2 * p0 - 2 * p1*x[0] - 2 * p2*pow(x[0], 2) - 2 * p3*pow(x[0], 3) + 2 * x[10]), w_cte*(-2 * p0 - 2 * p1*x[1] - 2 * p2*pow(x[1], 2) - 2 * p3*pow(x[1], 3) + 2 * x[11]), w_cte*(-2 * p0 - 2 * p1*x[2] - 2 * p2*pow(x[2], 2) - 2 * p3*pow(x[2], 3) + 2 * x[12]), w_cte*(-2 * p0 - 2 * p1*x[3] - 2 * p2*pow(x[3], 2) - 2 * p3*pow(x[3], 3) + 2 * x[13]), w_cte*(-2 * p0 - 2 * p1*x[4] - 2 * p2*pow(x[4], 2) - 2 * p3*pow(x[4], 3) + 2 * x[14]), w_cte*(-2 * p0 - 2 * p1*x[5] - 2 * p2*pow(x[5], 2) - 2 * p3*pow(x[5], 3) + 2 * x[15]), w_cte*(-2 * p0 - 2 * p1*x[6] - 2 * p2*pow(x[6], 2) - 2 * p3*pow(x[6], 3) + 2 * x[16]), w_cte*(-2 * p0 - 2 * p1*x[7] - 2 * p2*pow(x[7], 2) - 2 * p3*pow(x[7], 3) + 2 * x[17]), w_cte*(-2 * p0 - 2 * p1*x[8] - 2 * p2*pow(x[8], 2) - 2 * p3*pow(x[8], 3) + 2 * x[18]), w_cte*(-2 * p0 - 2 * p1*x[9] - 2 * p2*pow(x[9], 2) - 2 * p3*pow(x[9], 3) + 2 * x[19]), w_v*(-2 * ref_v + 2 * x[20]), w_v*(-2 * ref_v + 2 * x[21]), w_v*(-2 * ref_v + 2 * x[22]), w_v*(-2 * ref_v + 2 * x[23]), w_v*(-2 * ref_v + 2 * x[24]), w_v*(-2 * ref_v + 2 * x[25]), w_v*(-2 * ref_v + 2 * x[26]), w_v*(-2 * ref_v + 2 * x[27]), w_v*(-2 * ref_v + 2 * x[28]), w_v*(-2 * ref_v + 2 * x[29]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, w_ep*(2 * x[50] - 2 * atan(p1 + 2 * p2*x[0] + 3 * p3*x[0])), w_ep*(2 * x[51] - 2 * atan(p1 + 2 * p2*x[1] + 3 * p3*x[1])), w_ep*(2 * x[52] - 2 * atan(p1 + 2 * p2*x[2] + 3 * p3*x[2])), w_ep*(2 * x[53] - 2 * atan(p1 + 2 * p2*x[3] + 3 * p3*x[3])), w_ep*(2 * x[54] - 2 * atan(p1 + 2 * p2*x[4] + 3 * p3*x[4])), w_ep*(2 * x[55] - 2 * atan(p1 + 2 * p2*x[5] + 3 * p3*x[5])), w_ep*(2 * x[56] - 2 * atan(p1 + 2 * p2*x[6] + 3 * p3*x[6])), w_ep*(2 * x[57] - 2 * atan(p1 + 2 * p2*x[7] + 3 * p3*x[7])), w_ep*(2 * x[58] - 2 * atan(p1 + 2 * p2*x[8] + 3 * p3*x[8])), w_ep*(2 * x[59] - 2 * atan(p1 + 2 * p2*x[9] + 3 * p3*x[9])), 2 * w_s*x[60] + w_sd * (2 * x[60] - 2 * x[61]), 2 * w_s*x[61] + w_sd * (-2 * x[60] + 2 * x[61]) + w_sd * (2 * x[61] - 2 * x[62]), 2 * w_s*x[62] + w_sd * (-2 * x[61] + 2 * x[62]) + w_sd * (2 * x[62] - 2 * x[63]), 2 * w_s*x[63] + w_sd * (-2 * x[62] + 2 * x[63]) + w_sd * (2 * x[63] - 2 * x[64]), 2 * w_s*x[64] + w_sd * (-2 * x[63] + 2 * x[64]) + w_sd * (2 * x[64] - 2 * x[65]), 2 * w_s*x[65] + w_sd * (-2 * x[64] + 2 * x[65]) + w_sd * (2 * x[65] - 2 * x[66]), 2 * w_s*x[66] + w_sd * (-2 * x[65] + 2 * x[66]) + w_sd * (2 * x[66] - 2 * x[67]), 2 * w_s*x[67] + w_sd * (-2 * x[66] + 2 * x[67]) + w_sd * (2 * x[67] - 2 * x[68]), 2 * w_s*x[68] + w_sd * (-2 * x[67] + 2 * x[68]), 2 * w_a*x[69] + w_ad * (2 * x[69] - 2 * x[70]), 2 * w_a*x[70] + w_ad * (-2 * x[69] + 2 * x[70]) + w_ad * (2 * x[70] - 2 * x[71]), 2 * w_a*x[71] + w_ad * (-2 * x[70] + 2 * x[71]) + w_ad * (2 * x[71] - 2 * x[72]), 2 * w_a*x[72] + w_ad * (-2 * x[71] + 2 * x[72]) + w_ad * (2 * x[72] - 2 * x[73]), 2 * w_a*x[73] + w_ad * (-2 * x[72] + 2 * x[73]) + w_ad * (2 * x[73] - 2 * x[74]), 2 * w_a*x[74] + w_ad * (-2 * x[73] + 2 * x[74]) + w_ad * (2 * x[74] - 2 * x[75]), 2 * w_a*x[75] + w_ad * (-2 * x[74] + 2 * x[75]) + w_ad * (2 * x[75] - 2 * x[76]), 2 * w_a*x[76] + w_ad * (-2 * x[75] + 2 * x[76]) + w_ad * (2 * x[76] - 2 * x[77]), 2 * w_a*x[77] + w_ad * (-2 * x[76] + 2 * x[77]);
		}

		void hf(VectorXd &value, VectorXd const &x)
		{
			value.resize(m_l);

			double p0 = args.coeffs[0];
			double p1 = args.coeffs[1];
			double p2 = args.coeffs[2];
			double p3 = args.coeffs[3];

			double ref_v = args.ref_v;

			double w_cte = settings.w_cte;
			double w_v = settings.w_v;
			double w_s = settings.w_s;
			double w_a = settings.w_a;
			double w_sd = settings.w_sd;
			double w_ad = settings.w_ad;
			double w_ep = settings.w_epsi;

			double dt = settings.dt;
			double Lf = settings.Lf;
			double Lr = settings.Lr;
			double Caf = settings.Caf;
			double Car = settings.Car;
			double m = settings.Mass;
			double I = settings.I;

			double argx = args.x;
			double argy = args.y;
			double argvx = args.vx;
			double argvy = args.vy;
			double argr = args.r;
			double argp = args.psi;

			value << -argx + x[0], -dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]) - x[0] + x[1], -dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]) - x[1] + x[2], -dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]) - x[2] + x[3], -dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]) - x[3] + x[4], -dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]) - x[4] + x[5], -dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]) - x[5] + x[6], -dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]) - x[6] + x[7], -dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]) - x[7] + x[8], -dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]) - x[8] + x[9], -argy + x[10], -dt * x[20] * sin(x[50]) - dt * x[30] * cos(x[50]) - x[10] + x[11], -dt * x[21] * sin(x[51]) - dt * x[31] * cos(x[51]) - x[11] + x[12], -dt * x[22] * sin(x[52]) - dt * x[32] * cos(x[52]) - x[12] + x[13], -dt * x[23] * sin(x[53]) - dt * x[33] * cos(x[53]) - x[13] + x[14], -dt * x[24] * sin(x[54]) - dt * x[34] * cos(x[54]) - x[14] + x[15], -dt * x[25] * sin(x[55]) - dt * x[35] * cos(x[55]) - x[15] + x[16], -dt * x[26] * sin(x[56]) - dt * x[36] * cos(x[56]) - x[16] + x[17], -dt * x[27] * sin(x[57]) - dt * x[37] * cos(x[57]) - x[17] + x[18], -dt * x[28] * sin(x[58]) - dt * x[38] * cos(x[58]) - x[18] + x[19], -argvx + x[20], -dt * x[69] - x[20] + x[21], -dt * x[70] - x[21] + x[22], -dt * x[71] - x[22] + x[23], -dt * x[72] - x[23] + x[24], -dt * x[73] - x[24] + x[25], -dt * x[74] - x[25] + x[26], -dt * x[75] - x[26] + x[27], -dt * x[76] - x[27] + x[28], -dt * x[77] - x[28] + x[29], -argvy + x[30], -dt * (2 * Caf*x[60] / m + x[40] * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])) + x[30] * (-2 * Caf - 2 * Car) / (m*x[20])) - x[30] + x[31], -dt * (2 * Caf*x[61] / m + x[41] * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])) + x[31] * (-2 * Caf - 2 * Car) / (m*x[21])) - x[31] + x[32], -dt * (2 * Caf*x[62] / m + x[42] * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])) + x[32] * (-2 * Caf - 2 * Car) / (m*x[22])) - x[32] + x[33], -dt * (2 * Caf*x[63] / m + x[43] * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])) + x[33] * (-2 * Caf - 2 * Car) / (m*x[23])) - x[33] + x[34], -dt * (2 * Caf*x[64] / m + x[44] * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])) + x[34] * (-2 * Caf - 2 * Car) / (m*x[24])) - x[34] + x[35], -dt * (2 * Caf*x[65] / m + x[45] * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])) + x[35] * (-2 * Caf - 2 * Car) / (m*x[25])) - x[35] + x[36], -dt * (2 * Caf*x[66] / m + x[46] * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])) + x[36] * (-2 * Caf - 2 * Car) / (m*x[26])) - x[36] + x[37], -dt * (2 * Caf*x[67] / m + x[47] * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])) + x[37] * (-2 * Caf - 2 * Car) / (m*x[27])) - x[37] + x[38], -dt * (2 * Caf*x[68] / m + x[48] * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])) + x[38] * (-2 * Caf - 2 * Car) / (m*x[28])) - x[38] + x[39], -argr + x[40], -dt * (2 * Caf*Lf*x[60] / I + x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]) + x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) - x[40] + x[41], -dt * (2 * Caf*Lf*x[61] / I + x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]) + x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) - x[41] + x[42], -dt * (2 * Caf*Lf*x[62] / I + x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]) + x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) - x[42] + x[43], -dt * (2 * Caf*Lf*x[63] / I + x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]) + x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) - x[43] + x[44], -dt * (2 * Caf*Lf*x[64] / I + x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]) + x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) - x[44] + x[45], -dt * (2 * Caf*Lf*x[65] / I + x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]) + x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) - x[45] + x[46], -dt * (2 * Caf*Lf*x[66] / I + x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]) + x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) - x[46] + x[47], -dt * (2 * Caf*Lf*x[67] / I + x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]) + x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) - x[47] + x[48], -dt * (2 * Caf*Lf*x[68] / I + x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]) + x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) - x[48] + x[49], -argp + x[50], -dt * x[40] - x[50] + x[51], -dt * x[41] - x[51] + x[52], -dt * x[42] - x[52] + x[53], -dt * x[43] - x[53] + x[54], -dt * x[44] - x[54] + x[55], -dt * x[45] - x[55] + x[56], -dt * x[46] - x[56] + x[57], -dt * x[47] - x[57] + x[58], -dt * x[48] - x[58] + x[59];
		}

		void gf(VectorXd &value, VectorXd const &x)
		{
			value.resize(m_m);

			double s_max = settings.steer_max;
			double s_min = settings.steer_min;

			double a_max = settings.a_max;
			double a_min = settings.a_min;

			value << s_max - x[60], s_max - x[61], s_max - x[62], s_max - x[63], s_max - x[64], s_max - x[65], s_max - x[66], s_max - x[67], s_max - x[68], -s_min + x[60], -s_min + x[61], -s_min + x[62], -s_min + x[63], -s_min + x[64], -s_min + x[65], -s_min + x[66], -s_min + x[67], -s_min + x[68], a_max - x[69], a_max - x[70], a_max - x[71], a_max - x[72], a_max - x[73], a_max - x[74], a_max - x[75], a_max - x[76], a_max - x[77], -a_min + x[69], -a_min + x[70], -a_min + x[71], -a_min + x[72], -a_min + x[73], -a_min + x[74], -a_min + x[75], -a_min + x[76], -a_min + x[77];
		}

		void dhf(MatrixXd &grad, VectorXd &x)
		{
			grad.resize(m_n, m_l);

			double p0 = args.coeffs[0];
			double p1 = args.coeffs[1];
			double p2 = args.coeffs[2];
			double p3 = args.coeffs[3];

			double ref_v = args.ref_v;

			double w_cte = settings.w_cte;
			double w_v = settings.w_v;
			double w_s = settings.w_s;
			double w_a = settings.w_a;
			double w_sd = settings.w_sd;
			double w_ad = settings.w_ad;
			double w_ep = settings.w_epsi;

			double dt = settings.dt;
			double Lf = settings.Lf;
			double Lr = settings.Lr;
			double Caf = settings.Caf;
			double Car = settings.Car;
			double m = settings.Mass;
			double I = settings.I;

			grad << 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, -dt * cos(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, -dt * cos(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, -dt * cos(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, -dt * cos(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, -dt * cos(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, -dt * cos(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, -dt * cos(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * sin(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, dt*sin(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[20]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, dt*sin(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[21]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, dt*sin(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[22]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, dt*sin(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[23]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, dt*sin(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[24]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, dt*sin(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[25]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, dt*sin(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[26]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, dt*sin(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[27]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, dt*sin(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * cos(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -dt * (-2 * Caf - 2 * Car) / (m*x[28]) - 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])), 0, 0, 0, 0, 0, 0, 0, 0, 1, -1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, dt*x[20] * sin(x[50]) + dt * x[30] * cos(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, dt*x[21] * sin(x[51]) + dt * x[31] * cos(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, dt*x[22] * sin(x[52]) + dt * x[32] * cos(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, dt*x[23] * sin(x[53]) + dt * x[33] * cos(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, dt*x[24] * sin(x[54]) + dt * x[34] * cos(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, dt*x[25] * sin(x[55]) + dt * x[35] * cos(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, dt*x[26] * sin(x[56]) + dt * x[36] * cos(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, dt*x[27] * sin(x[57]) + dt * x[37] * cos(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, dt*x[28] * sin(x[58]) + dt * x[38] * cos(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*dt / m, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * Caf*Lf*dt / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;

		}

		void dgf(MatrixXd &grad, VectorXd &x)
		{
			grad.resize(m_n, m_m);

			grad << 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				-1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 1;
		}

		double mpsi(VectorXd const &x, VectorXd &mu, VectorXd &lambda, double sigma)
		{
			double f = cost(x);
			VectorXd he, gi;
			hf(he, x);
			gf(gi, x);

			size_t l = he.size();
			size_t m = gi.size();
			double s1 = 0.;
			double psi = f;

			for (size_t i = 0; i < l; i++)
			{
				psi = psi - he[i] * mu[i];
				s1 = s1 + he[i] * he[i];
			}
			psi += 0.5 * sigma * s1;
			double s2 = 0., s3 = 0.;
			for (size_t i = 0; i < m; i++)
			{
				s3 = std::max(0., lambda[i] - sigma * gi[i]);
				s2 += s3 * s3 - lambda[i] * lambda[i];
			}
			psi += s2 / (2. * sigma);
			return psi;
		}

		void dmpsi(VectorXd &dpsi, VectorXd &x, VectorXd &mu, VectorXd &lambda, double sigma)
		{
			grad(dpsi, x);
			VectorXd he, gi;
			MatrixXd dhe, dgi;
			hf(he, x);
			gf(gi, x);
			dhf(dhe, x);
			dgf(dgi, x);

			size_t l = he.size();
			size_t m = gi.size();
			for (size_t i = 0;i < l;++i)
			{
				dpsi = dpsi + (sigma * he[i] - mu[i]) * dhe.col(i);
			}

			for (size_t i = 0;i < m;++i)
			{
				if (lambda[i] - sigma * gi[i] > 0)
				{
					dpsi = dpsi + (sigma * gi[i] - lambda[i]) * dgi.col(i);
				}
			}
		}

		void hmpsi(MatrixXd &hpsi, VectorXd &x, VectorXd &mu, VectorXd &lam, double sigma)
		{
			double p0 = args.coeffs[0];
			double p1 = args.coeffs[1];
			double p2 = args.coeffs[2];
			double p3 = args.coeffs[3];

			double ref_v = args.ref_v;

			double w_cte = settings.w_cte;
			double w_v = settings.w_v;
			double w_s = settings.w_s;
			double w_a = settings.w_a;
			double w_sd = settings.w_sd;
			double w_ad = settings.w_ad;
			double w_ep = settings.w_epsi;

			double dt = settings.dt;
			double Lf = settings.Lf;
			double Lr = settings.Lr;
			double Caf = settings.Caf;
			double Car = settings.Car;
			double m = settings.Mass;
			double I = settings.I;

			double s_max = settings.steer_max;
			double s_min = settings.steer_min;

			double a_max = settings.a_max;
			double a_min = settings.a_min;

			std::vector<double> buf(78 * 79 / 2);
			buf = { 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[0])*(p0 + p1 * x[0] + p2 * pow(x[0], 2) + p3 * pow(x[0], 3) - x[10]) + w_cte * (p1 + 2 * p2*x[0] + 3 * p3*pow(x[0], 2))*(2 * p1 + 4 * p2*x[0] + 6 * p3*pow(x[0], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[0] + 3 * p3*x[0], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[50] - atan(p1 + 2 * p2*x[0] + 3 * p3*x[0]))*(p1 + 2 * p2*x[0] + 3 * p3*x[0]) / pow(pow(p1 + 2 * p2*x[0] + 3 * p3*x[0], 2) + 1, 2), -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[1])*(p0 + p1 * x[1] + p2 * pow(x[1], 2) + p3 * pow(x[1], 3) - x[11]) + w_cte * (p1 + 2 * p2*x[1] + 3 * p3*pow(x[1], 2))*(2 * p1 + 4 * p2*x[1] + 6 * p3*pow(x[1], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[1] + 3 * p3*x[1], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[51] - atan(p1 + 2 * p2*x[1] + 3 * p3*x[1]))*(p1 + 2 * p2*x[1] + 3 * p3*x[1]) / pow(pow(p1 + 2 * p2*x[1] + 3 * p3*x[1], 2) + 1, 2), 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[2])*(p0 + p1 * x[2] + p2 * pow(x[2], 2) + p3 * pow(x[2], 3) - x[12]) + w_cte * (p1 + 2 * p2*x[2] + 3 * p3*pow(x[2], 2))*(2 * p1 + 4 * p2*x[2] + 6 * p3*pow(x[2], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[2] + 3 * p3*x[2], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[52] - atan(p1 + 2 * p2*x[2] + 3 * p3*x[2]))*(p1 + 2 * p2*x[2] + 3 * p3*x[2]) / pow(pow(p1 + 2 * p2*x[2] + 3 * p3*x[2], 2) + 1, 2), 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[3])*(p0 + p1 * x[3] + p2 * pow(x[3], 2) + p3 * pow(x[3], 3) - x[13]) + w_cte * (p1 + 2 * p2*x[3] + 3 * p3*pow(x[3], 2))*(2 * p1 + 4 * p2*x[3] + 6 * p3*pow(x[3], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[3] + 3 * p3*x[3], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[53] - atan(p1 + 2 * p2*x[3] + 3 * p3*x[3]))*(p1 + 2 * p2*x[3] + 3 * p3*x[3]) / pow(pow(p1 + 2 * p2*x[3] + 3 * p3*x[3], 2) + 1, 2), 0, 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[4])*(p0 + p1 * x[4] + p2 * pow(x[4], 2) + p3 * pow(x[4], 3) - x[14]) + w_cte * (p1 + 2 * p2*x[4] + 3 * p3*pow(x[4], 2))*(2 * p1 + 4 * p2*x[4] + 6 * p3*pow(x[4], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[4] + 3 * p3*x[4], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[54] - atan(p1 + 2 * p2*x[4] + 3 * p3*x[4]))*(p1 + 2 * p2*x[4] + 3 * p3*x[4]) / pow(pow(p1 + 2 * p2*x[4] + 3 * p3*x[4], 2) + 1, 2), 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[5])*(p0 + p1 * x[5] + p2 * pow(x[5], 2) + p3 * pow(x[5], 3) - x[15]) + w_cte * (p1 + 2 * p2*x[5] + 3 * p3*pow(x[5], 2))*(2 * p1 + 4 * p2*x[5] + 6 * p3*pow(x[5], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[5] + 3 * p3*x[5], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[55] - atan(p1 + 2 * p2*x[5] + 3 * p3*x[5]))*(p1 + 2 * p2*x[5] + 3 * p3*x[5]) / pow(pow(p1 + 2 * p2*x[5] + 3 * p3*x[5], 2) + 1, 2), 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[6])*(p0 + p1 * x[6] + p2 * pow(x[6], 2) + p3 * pow(x[6], 3) - x[16]) + w_cte * (p1 + 2 * p2*x[6] + 3 * p3*pow(x[6], 2))*(2 * p1 + 4 * p2*x[6] + 6 * p3*pow(x[6], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[6] + 3 * p3*x[6], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[56] - atan(p1 + 2 * p2*x[6] + 3 * p3*x[6]))*(p1 + 2 * p2*x[6] + 3 * p3*x[6]) / pow(pow(p1 + 2 * p2*x[6] + 3 * p3*x[6], 2) + 1, 2), 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[7])*(p0 + p1 * x[7] + p2 * pow(x[7], 2) + p3 * pow(x[7], 3) - x[17]) + w_cte * (p1 + 2 * p2*x[7] + 3 * p3*pow(x[7], 2))*(2 * p1 + 4 * p2*x[7] + 6 * p3*pow(x[7], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[7] + 3 * p3*x[7], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[57] - atan(p1 + 2 * p2*x[7] + 3 * p3*x[7]))*(p1 + 2 * p2*x[7] + 3 * p3*x[7]) / pow(pow(p1 + 2 * p2*x[7] + 3 * p3*x[7], 2) + 1, 2), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + w_cte * (4 * p2 + 12 * p3*x[8])*(p0 + p1 * x[8] + p2 * pow(x[8], 2) + p3 * pow(x[8], 3) - x[18]) + w_cte * (p1 + 2 * p2*x[8] + 3 * p3*pow(x[8], 2))*(2 * p1 + 4 * p2*x[8] + 6 * p3*pow(x[8], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[8] + 3 * p3*x[8], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[58] - atan(p1 + 2 * p2*x[8] + 3 * p3*x[8]))*(p1 + 2 * p2*x[8] + 3 * p3*x[8]) / pow(pow(p1 + 2 * p2*x[8] + 3 * p3*x[8], 2) + 1, 2), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 1.0*sigma + w_cte * (4 * p2 + 12 * p3*x[9])*(p0 + p1 * x[9] + p2 * pow(x[9], 2) + p3 * pow(x[9], 3) - x[19]) + w_cte * (p1 + 2 * p2*x[9] + 3 * p3*pow(x[9], 2))*(2 * p1 + 4 * p2*x[9] + 6 * p3*pow(x[9], 2)) + 2 * w_ep*pow(2 * p2 + 3 * p3, 2) / pow(pow(p1 + 2 * p2*x[9] + 3 * p3*x[9], 2) + 1, 2) + 2 * w_ep*(2 * p2 + 3 * p3)*(4 * p2 + 6 * p3)*(x[59] - atan(p1 + 2 * p2*x[9] + 3 * p3*x[9]))*(p1 + 2 * p2*x[9] + 3 * p3*x[9]) / pow(pow(p1 + 2 * p2*x[9] + 3 * p3*x[9], 2) + 1, 2), -w_cte * (2 * p1 + 4 * p2*x[0] + 6 * p3*pow(x[0], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, 2.0*sigma + 2 * w_cte, 0, -w_cte * (2 * p1 + 4 * p2*x[1] + 6 * p3*pow(x[1], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[2] + 6 * p3*pow(x[2], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[3] + 6 * p3*pow(x[3], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[4] + 6 * p3*pow(x[4], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[5] + 6 * p3*pow(x[5], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[6] + 6 * p3*pow(x[6], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[7] + 6 * p3*pow(x[7], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[8] + 6 * p3*pow(x[8], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 2.0*sigma + 2 * w_cte, 0, 0, 0, 0, 0, 0, 0, 0, 0, -w_cte * (2 * p1 + 4 * p2*x[9] + 6 * p3*pow(x[9], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 1.0*sigma + 2 * w_cte, 1.0*dt*sigma*cos(x[50]), -1.0*dt*sigma*cos(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[50]), -1.0*dt*sigma*sin(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[31] * (2 * x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 3)) + 2 * x[40] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 3))) + dt * mu[41] * (2 * x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 3)) + 2 * x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2)), 2) + 2 * pow(dt, 2)*pow(-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[50]), 2) + 2 * pow(dt, 2)*pow(cos(x[50]), 2) - 2 * dt*(2 * x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 3)) + 2 * x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 3)))*(-dt * (2 * Caf*Lf*x[60] / I + x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]) + x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) - x[40] + x[41]) - 2 * dt*(2 * x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 3)) + 2 * x[40] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 3)))*(-dt * (2 * Caf*x[60] / m + x[40] * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])) + x[30] * (-2 * Caf - 2 * Car) / (m*x[20])) - x[30] + x[31]) + 4) + 2 * w_v, 0, 1.0*dt*sigma*cos(x[51]), -1.0*dt*sigma*cos(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[51]), -1.0*dt*sigma*sin(x[51]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[32] * (2 * x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 3)) + 2 * x[41] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 3))) + dt * mu[42] * (2 * x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 3)) + 2 * x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2)), 2) + 2 * pow(dt, 2)*pow(-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[51]), 2) + 2 * pow(dt, 2)*pow(cos(x[51]), 2) - 2 * dt*(2 * x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 3)) + 2 * x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 3)))*(-dt * (2 * Caf*Lf*x[61] / I + x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]) + x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) - x[41] + x[42]) - 2 * dt*(2 * x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 3)) + 2 * x[41] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 3)))*(-dt * (2 * Caf*x[61] / m + x[41] * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])) + x[31] * (-2 * Caf - 2 * Car) / (m*x[21])) - x[31] + x[32]) + 4) + 2 * w_v, 0, 0, 1.0*dt*sigma*cos(x[52]), -1.0*dt*sigma*cos(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[52]), -1.0*dt*sigma*sin(x[52]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[33] * (2 * x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 3)) + 2 * x[42] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 3))) + dt * mu[43] * (2 * x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 3)) + 2 * x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2)), 2) + 2 * pow(dt, 2)*pow(-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[52]), 2) + 2 * pow(dt, 2)*pow(cos(x[52]), 2) - 2 * dt*(2 * x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 3)) + 2 * x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 3)))*(-dt * (2 * Caf*Lf*x[62] / I + x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]) + x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) - x[42] + x[43]) - 2 * dt*(2 * x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 3)) + 2 * x[42] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 3)))*(-dt * (2 * Caf*x[62] / m + x[42] * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])) + x[32] * (-2 * Caf - 2 * Car) / (m*x[22])) - x[32] + x[33]) + 4) + 2 * w_v, 0, 0, 0, 1.0*dt*sigma*cos(x[53]), -1.0*dt*sigma*cos(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[53]), -1.0*dt*sigma*sin(x[53]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[34] * (2 * x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 3)) + 2 * x[43] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 3))) + dt * mu[44] * (2 * x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 3)) + 2 * x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2)), 2) + 2 * pow(dt, 2)*pow(-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[53]), 2) + 2 * pow(dt, 2)*pow(cos(x[53]), 2) - 2 * dt*(2 * x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 3)) + 2 * x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 3)))*(-dt * (2 * Caf*Lf*x[63] / I + x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]) + x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) - x[43] + x[44]) - 2 * dt*(2 * x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 3)) + 2 * x[43] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 3)))*(-dt * (2 * Caf*x[63] / m + x[43] * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])) + x[33] * (-2 * Caf - 2 * Car) / (m*x[23])) - x[33] + x[34]) + 4) + 2 * w_v, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[54]), -1.0*dt*sigma*cos(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[54]), -1.0*dt*sigma*sin(x[54]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[35] * (2 * x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 3)) + 2 * x[44] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 3))) + dt * mu[45] * (2 * x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 3)) + 2 * x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2)), 2) + 2 * pow(dt, 2)*pow(-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[54]), 2) + 2 * pow(dt, 2)*pow(cos(x[54]), 2) - 2 * dt*(2 * x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 3)) + 2 * x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 3)))*(-dt * (2 * Caf*Lf*x[64] / I + x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]) + x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) - x[44] + x[45]) - 2 * dt*(2 * x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 3)) + 2 * x[44] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 3)))*(-dt * (2 * Caf*x[64] / m + x[44] * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])) + x[34] * (-2 * Caf - 2 * Car) / (m*x[24])) - x[34] + x[35]) + 4) + 2 * w_v, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[55]), -1.0*dt*sigma*cos(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[55]), -1.0*dt*sigma*sin(x[55]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[36] * (2 * x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 3)) + 2 * x[45] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 3))) + dt * mu[46] * (2 * x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 3)) + 2 * x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2)), 2) + 2 * pow(dt, 2)*pow(-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[55]), 2) + 2 * pow(dt, 2)*pow(cos(x[55]), 2) - 2 * dt*(2 * x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 3)) + 2 * x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 3)))*(-dt * (2 * Caf*Lf*x[65] / I + x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]) + x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) - x[45] + x[46]) - 2 * dt*(2 * x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 3)) + 2 * x[45] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 3)))*(-dt * (2 * Caf*x[65] / m + x[45] * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])) + x[35] * (-2 * Caf - 2 * Car) / (m*x[25])) - x[35] + x[36]) + 4) + 2 * w_v, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[56]), -1.0*dt*sigma*cos(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[56]), -1.0*dt*sigma*sin(x[56]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[37] * (2 * x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 3)) + 2 * x[46] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 3))) + dt * mu[47] * (2 * x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 3)) + 2 * x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2)), 2) + 2 * pow(dt, 2)*pow(-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[56]), 2) + 2 * pow(dt, 2)*pow(cos(x[56]), 2) - 2 * dt*(2 * x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 3)) + 2 * x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 3)))*(-dt * (2 * Caf*Lf*x[66] / I + x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]) + x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) - x[46] + x[47]) - 2 * dt*(2 * x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 3)) + 2 * x[46] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 3)))*(-dt * (2 * Caf*x[66] / m + x[46] * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])) + x[36] * (-2 * Caf - 2 * Car) / (m*x[26])) - x[36] + x[37]) + 4) + 2 * w_v, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[57]), -1.0*dt*sigma*cos(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[57]), -1.0*dt*sigma*sin(x[57]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[38] * (2 * x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 3)) + 2 * x[47] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 3))) + dt * mu[48] * (2 * x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 3)) + 2 * x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2)), 2) + 2 * pow(dt, 2)*pow(-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[57]), 2) + 2 * pow(dt, 2)*pow(cos(x[57]), 2) - 2 * dt*(2 * x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 3)) + 2 * x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 3)))*(-dt * (2 * Caf*Lf*x[67] / I + x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]) + x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) - x[47] + x[48]) - 2 * dt*(2 * x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 3)) + 2 * x[47] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 3)))*(-dt * (2 * Caf*x[67] / m + x[47] * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])) + x[37] * (-2 * Caf - 2 * Car) / (m*x[27])) - x[37] + x[38]) + 4) + 2 * w_v, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[58]), -1.0*dt*sigma*cos(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*sin(x[58]), -1.0*dt*sigma*sin(x[58]), 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, dt*mu[39] * (2 * x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 3)) + 2 * x[48] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 3))) + dt * mu[49] * (2 * x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 3)) + 2 * x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 3))) + 0.5*sigma*(2 * pow(dt, 2)*pow(x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2)), 2) + 2 * pow(dt, 2)*pow(-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2)), 2) + 2 * pow(dt, 2)*pow(sin(x[58]), 2) + 2 * pow(dt, 2)*pow(cos(x[58]), 2) - 2 * dt*(2 * x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 3)) + 2 * x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 3)))*(-dt * (2 * Caf*Lf*x[68] / I + x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]) + x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) - x[48] + x[49]) - 2 * dt*(2 * x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 3)) + 2 * x[48] * (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 3)))*(-dt * (2 * Caf*x[68] / m + x[48] * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])) + x[38] * (-2 * Caf - 2 * Car) / (m*x[28])) - x[38] + x[39]) + 4) + 2 * w_v, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 1.0*sigma + 2 * w_v, -1.0*dt*sigma*sin(x[50]), 1.0*dt*sigma*sin(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[50]), -1.0*dt*sigma*cos(x[50]), 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[31] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2)) + 0.5*sigma*(-2 * dt*(x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[20]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[60] / m + x[40] * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])) + x[30] * (-2 * Caf - 2 * Car) / (m*x[20])) - x[30] + x[31]) / (m*pow(x[20], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2))) / (I*x[20]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[60] / I + x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]) + x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) - x[40] + x[41]) / (I*pow(x[20], 2))) - dt * mu[41] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[50]), 2) + 2 * pow(dt, 2)*pow(cos(x[50]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[20]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[20]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[20], 2))), 0, -1.0*dt*sigma*sin(x[51]), 1.0*dt*sigma*sin(x[51]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[51]), -1.0*dt*sigma*cos(x[51]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2))), -dt * mu[32] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2)) + 0.5*sigma*(-2 * dt*(x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[21]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[61] / m + x[41] * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])) + x[31] * (-2 * Caf - 2 * Car) / (m*x[21])) - x[31] + x[32]) / (m*pow(x[21], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2))) / (I*x[21]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[61] / I + x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]) + x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) - x[41] + x[42]) / (I*pow(x[21], 2))) - dt * mu[42] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[20]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[51]), 2) + 2 * pow(dt, 2)*pow(cos(x[51]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[21]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[21]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[21], 2))), 0, 0, -1.0*dt*sigma*sin(x[52]), 1.0*dt*sigma*sin(x[52]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[52]), -1.0*dt*sigma*cos(x[52]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2))), -dt * mu[33] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2)) + 0.5*sigma*(-2 * dt*(x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[22]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[62] / m + x[42] * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])) + x[32] * (-2 * Caf - 2 * Car) / (m*x[22])) - x[32] + x[33]) / (m*pow(x[22], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2))) / (I*x[22]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[62] / I + x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]) + x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) - x[42] + x[43]) / (I*pow(x[22], 2))) - dt * mu[43] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[21]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[52]), 2) + 2 * pow(dt, 2)*pow(cos(x[52]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[22]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[22]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[22], 2))), 0, 0, 0, -1.0*dt*sigma*sin(x[53]), 1.0*dt*sigma*sin(x[53]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[53]), -1.0*dt*sigma*cos(x[53]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2))), -dt * mu[34] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2)) + 0.5*sigma*(-2 * dt*(x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[23]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[63] / m + x[43] * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])) + x[33] * (-2 * Caf - 2 * Car) / (m*x[23])) - x[33] + x[34]) / (m*pow(x[23], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2))) / (I*x[23]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[63] / I + x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]) + x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) - x[43] + x[44]) / (I*pow(x[23], 2))) - dt * mu[44] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[22]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[53]), 2) + 2 * pow(dt, 2)*pow(cos(x[53]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[23]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[23]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[23], 2))), 0, 0, 0, 0, -1.0*dt*sigma*sin(x[54]), 1.0*dt*sigma*sin(x[54]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[54]), -1.0*dt*sigma*cos(x[54]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2))), -dt * mu[35] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2)) + 0.5*sigma*(-2 * dt*(x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[24]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[64] / m + x[44] * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])) + x[34] * (-2 * Caf - 2 * Car) / (m*x[24])) - x[34] + x[35]) / (m*pow(x[24], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2))) / (I*x[24]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[64] / I + x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]) + x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) - x[44] + x[45]) / (I*pow(x[24], 2))) - dt * mu[45] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[23]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[54]), 2) + 2 * pow(dt, 2)*pow(cos(x[54]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[24]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[24]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[24], 2))), 0, 0, 0, 0, 0, -1.0*dt*sigma*sin(x[55]), 1.0*dt*sigma*sin(x[55]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[55]), -1.0*dt*sigma*cos(x[55]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2))), -dt * mu[36] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2)) + 0.5*sigma*(-2 * dt*(x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[25]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[65] / m + x[45] * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])) + x[35] * (-2 * Caf - 2 * Car) / (m*x[25])) - x[35] + x[36]) / (m*pow(x[25], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2))) / (I*x[25]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[65] / I + x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]) + x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) - x[45] + x[46]) / (I*pow(x[25], 2))) - dt * mu[46] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[24]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[55]), 2) + 2 * pow(dt, 2)*pow(cos(x[55]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[25]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[25]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[25], 2))), 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*sin(x[56]), 1.0*dt*sigma*sin(x[56]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[56]), -1.0*dt*sigma*cos(x[56]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2))), -dt * mu[37] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2)) + 0.5*sigma*(-2 * dt*(x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[26]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[66] / m + x[46] * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])) + x[36] * (-2 * Caf - 2 * Car) / (m*x[26])) - x[36] + x[37]) / (m*pow(x[26], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2))) / (I*x[26]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[66] / I + x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]) + x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) - x[46] + x[47]) / (I*pow(x[26], 2))) - dt * mu[47] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[25]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[56]), 2) + 2 * pow(dt, 2)*pow(cos(x[56]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[26]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[26]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[26], 2))), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*sin(x[57]), 1.0*dt*sigma*sin(x[57]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[57]), -1.0*dt*sigma*cos(x[57]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2))), -dt * mu[38] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2)) + 0.5*sigma*(-2 * dt*(x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[27]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[67] / m + x[47] * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])) + x[37] * (-2 * Caf - 2 * Car) / (m*x[27])) - x[37] + x[38]) / (m*pow(x[27], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2))) / (I*x[27]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[67] / I + x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]) + x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) - x[47] + x[48]) / (I*pow(x[27], 2))) - dt * mu[48] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[26]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[57]), 2) + 2 * pow(dt, 2)*pow(cos(x[57]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[27]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[27]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[27], 2))), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*sin(x[58]), 1.0*dt*sigma*sin(x[58]), 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma*cos(x[58]), -1.0*dt*sigma*cos(x[58]), 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2))), -dt * mu[39] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2)) + 0.5*sigma*(-2 * dt*(x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2)))*(-dt * (-2 * Caf - 2 * Car) / (m*x[28]) - 1) + 2 * dt*(-2 * Caf - 2 * Car)*(-dt * (2 * Caf*x[68] / m + x[48] * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])) + x[38] * (-2 * Caf - 2 * Car) / (m*x[28])) - x[38] + x[39]) / (m*pow(x[28], 2)) + 2 * pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr)*(-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2))) / (I*x[28]) + 2 * dt*(-2 * Caf*Lf + 2 * Car*Lr)*(-dt * (2 * Caf*Lf*x[68] / I + x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]) + x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) - x[48] + x[49]) / (I*pow(x[28], 2))) - dt * mu[49] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[27]) - 2), 0.5*sigma*(2 * pow(dt, 2)*pow(sin(x[58]), 2) + 2 * pow(dt, 2)*pow(cos(x[58]), 2) + (-2 * dt*(-2 * Caf - 2 * Car) / (m*x[28]) - 2)*(-dt * (-2 * Caf - 2 * Car) / (m*x[28]) - 1) + 2 + 2 * pow(dt, 2)*pow(-2 * Caf*Lf + 2 * Car*Lr, 2) / (pow(I, 2)*pow(x[28], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[28]) - 2), 1.0*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[31] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20]))*(x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2)))*(-dt * (2 * Caf*x[60] / m + x[40] * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])) + x[30] * (-2 * Caf - 2 * Car) / (m*x[20])) - x[30] + x[31]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20]))*(-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[60] / I + x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]) + x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) - x[40] + x[41]) / (I*pow(x[20], 2))) - dt * mu[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-dt * (-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[20]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20])), -1.0*dt*sigma*(-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * pow(dt, 2)*pow(-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2))), dt*mu[32] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21]))*(x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2)))*(-dt * (2 * Caf*x[61] / m + x[41] * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])) + x[31] * (-2 * Caf - 2 * Car) / (m*x[21])) - x[31] + x[32]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21]))*(-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[61] / I + x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]) + x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) - x[41] + x[42]) / (I*pow(x[21], 2))) - dt * mu[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[20]), 0.5*sigma*(-dt * (-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[21]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21])), -1.0*dt*sigma*(-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2))), dt*mu[33] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22]))*(x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2)))*(-dt * (2 * Caf*x[62] / m + x[42] * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])) + x[32] * (-2 * Caf - 2 * Car) / (m*x[22])) - x[32] + x[33]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22]))*(-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[62] / I + x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]) + x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) - x[42] + x[43]) / (I*pow(x[22], 2))) - dt * mu[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[21]), 0.5*sigma*(-dt * (-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[22]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22])), -1.0*dt*sigma*(-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2))), dt*mu[34] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23]))*(x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2)))*(-dt * (2 * Caf*x[63] / m + x[43] * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])) + x[33] * (-2 * Caf - 2 * Car) / (m*x[23])) - x[33] + x[34]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23]))*(-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[63] / I + x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]) + x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) - x[43] + x[44]) / (I*pow(x[23], 2))) - dt * mu[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[22]), 0.5*sigma*(-dt * (-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[23]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23])), -1.0*dt*sigma*(-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2))), dt*mu[35] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24]))*(x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2)))*(-dt * (2 * Caf*x[64] / m + x[44] * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])) + x[34] * (-2 * Caf - 2 * Car) / (m*x[24])) - x[34] + x[35]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24]))*(-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[64] / I + x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]) + x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) - x[44] + x[45]) / (I*pow(x[24], 2))) - dt * mu[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[23]), 0.5*sigma*(-dt * (-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[24]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24])), -1.0*dt*sigma*(-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2))), dt*mu[36] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25]))*(x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2)))*(-dt * (2 * Caf*x[65] / m + x[45] * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])) + x[35] * (-2 * Caf - 2 * Car) / (m*x[25])) - x[35] + x[36]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25]))*(-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[65] / I + x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]) + x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) - x[45] + x[46]) / (I*pow(x[25], 2))) - dt * mu[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[24]), 0.5*sigma*(-dt * (-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[25]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25])), -1.0*dt*sigma*(-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2))), dt*mu[37] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26]))*(x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2)))*(-dt * (2 * Caf*x[66] / m + x[46] * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])) + x[36] * (-2 * Caf - 2 * Car) / (m*x[26])) - x[36] + x[37]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26]))*(-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[66] / I + x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]) + x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) - x[46] + x[47]) / (I*pow(x[26], 2))) - dt * mu[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[25]), 0.5*sigma*(-dt * (-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[26]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26])), -1.0*dt*sigma*(-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2))), dt*mu[38] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27]))*(x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2)))*(-dt * (2 * Caf*x[67] / m + x[47] * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])) + x[37] * (-2 * Caf - 2 * Car) / (m*x[27])) - x[37] + x[38]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27]))*(-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[67] / I + x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]) + x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) - x[47] + x[48]) / (I*pow(x[27], 2))) - dt * mu[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[26]), 0.5*sigma*(-dt * (-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[27]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27])), -1.0*dt*sigma*(-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2))), dt*mu[39] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) + 0.5*sigma*(2 * pow(dt, 2)*(-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28]))*(x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2))) - 2 * dt*(-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2)))*(-dt * (2 * Caf*x[68] / m + x[48] * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])) + x[38] * (-2 * Caf - 2 * Car) / (m*x[28])) - x[38] + x[39]) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28]))*(-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2))) + 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2))*(-dt * (2 * Caf*Lf*x[68] / I + x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]) + x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) - x[48] + x[49]) / (I*pow(x[28], 2))) - dt * mu[49] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2)), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[27]), 0.5*sigma*(-dt * (-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28]))*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[28]) - 2) - 2 * dt*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28]))*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28])), -1.0*dt*sigma*(-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])), 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])), 0.5*sigma*(2 * pow(dt, 2)*pow(-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28]), 2) + 2 * pow(dt, 2) + (-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28]))*(-1 - dt * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) + 2), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2))), 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma*(-2 * Caf*Lf + 2 * Car*Lr) / (I*x[28]), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])), 1.0*sigma, 0.5*sigma*(-2 * dt*x[20] * sin(x[50]) - 2 * dt*x[30] * cos(x[50])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[0] + 3 * p3*x[0], 2) + 1), 0.5*sigma*(2 * dt*x[20] * sin(x[50]) + 2 * dt*x[30] * cos(x[50])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[20] * cos(x[50]) - 2 * dt*x[30] * sin(x[50])), 0.5*sigma*(-2 * dt*x[20] * cos(x[50]) + 2 * dt*x[30] * sin(x[50])), 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[1] * sin(x[50]) + dt * mu[11] * cos(x[50]) + 0.5*sigma*(-2 * dt*(dt*x[20] * sin(x[50]) + dt * x[30] * cos(x[50]))*cos(x[50]) - 2 * dt*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]))*sin(x[50]) - 2 * dt*(-dt * x[20] * sin(x[50]) - dt * x[30] * cos(x[50]) - x[10] + x[11])*cos(x[50]) + 2 * dt*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]) - x[0] + x[1])*sin(x[50])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[1] * cos(x[50]) - dt * mu[11] * sin(x[50]) + 0.5*sigma*(2 * dt*(dt*x[20] * sin(x[50]) + dt * x[30] * cos(x[50]))*sin(x[50]) - 2 * dt*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]))*cos(x[50]) + 2 * dt*(-dt * x[20] * sin(x[50]) - dt * x[30] * cos(x[50]) - x[10] + x[11])*sin(x[50]) + 2 * dt*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]) - x[0] + x[1])*cos(x[50])), 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, -mu[1] * (dt*x[20] * cos(x[50]) - dt * x[30] * sin(x[50])) - mu[11] * (dt*x[20] * sin(x[50]) + dt * x[30] * cos(x[50])) + 0.5*sigma*((dt*x[20] * sin(x[50]) + dt * x[30] * cos(x[50]))*(2 * dt*x[20] * sin(x[50]) + 2 * dt*x[30] * cos(x[50])) + (2 * dt*x[20] * sin(x[50]) + 2 * dt*x[30] * cos(x[50]))*(-dt * x[20] * sin(x[50]) - dt * x[30] * cos(x[50]) - x[10] + x[11]) + (-2 * dt*x[20] * cos(x[50]) + 2 * dt*x[30] * sin(x[50]))*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50])) + (2 * dt*x[20] * cos(x[50]) - 2 * dt*x[30] * sin(x[50]))*(-dt * x[20] * cos(x[50]) + dt * x[30] * sin(x[50]) - x[0] + x[1]) + 4) + 2 * w_ep, 0, 0.5*sigma*(-2 * dt*x[21] * sin(x[51]) - 2 * dt*x[31] * cos(x[51])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[1] + 3 * p3*x[1], 2) + 1), 0.5*sigma*(2 * dt*x[21] * sin(x[51]) + 2 * dt*x[31] * cos(x[51])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[21] * cos(x[51]) - 2 * dt*x[31] * sin(x[51])), 0.5*sigma*(-2 * dt*x[21] * cos(x[51]) + 2 * dt*x[31] * sin(x[51])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[12] * cos(x[51]) - dt * mu[2] * sin(x[51]) + 0.5*sigma*(-2 * dt*(dt*x[21] * sin(x[51]) + dt * x[31] * cos(x[51]))*cos(x[51]) - 2 * dt*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]))*sin(x[51]) - 2 * dt*(-dt * x[21] * sin(x[51]) - dt * x[31] * cos(x[51]) - x[11] + x[12])*cos(x[51]) + 2 * dt*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]) - x[1] + x[2])*sin(x[51])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[12] * sin(x[51]) - dt * mu[2] * cos(x[51]) + 0.5*sigma*(2 * dt*(dt*x[21] * sin(x[51]) + dt * x[31] * cos(x[51]))*sin(x[51]) - 2 * dt*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]))*cos(x[51]) + 2 * dt*(-dt * x[21] * sin(x[51]) - dt * x[31] * cos(x[51]) - x[11] + x[12])*sin(x[51]) + 2 * dt*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]) - x[1] + x[2])*cos(x[51])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[12] * (dt*x[21] * sin(x[51]) + dt * x[31] * cos(x[51])) - mu[2] * (dt*x[21] * cos(x[51]) - dt * x[31] * sin(x[51])) + 0.5*sigma*((dt*x[21] * sin(x[51]) + dt * x[31] * cos(x[51]))*(2 * dt*x[21] * sin(x[51]) + 2 * dt*x[31] * cos(x[51])) + (2 * dt*x[21] * sin(x[51]) + 2 * dt*x[31] * cos(x[51]))*(-dt * x[21] * sin(x[51]) - dt * x[31] * cos(x[51]) - x[11] + x[12]) + (-2 * dt*x[21] * cos(x[51]) + 2 * dt*x[31] * sin(x[51]))*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51])) + (2 * dt*x[21] * cos(x[51]) - 2 * dt*x[31] * sin(x[51]))*(-dt * x[21] * cos(x[51]) + dt * x[31] * sin(x[51]) - x[1] + x[2]) + 4) + 2 * w_ep, 0, 0, 0.5*sigma*(-2 * dt*x[22] * sin(x[52]) - 2 * dt*x[32] * cos(x[52])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[2] + 3 * p3*x[2], 2) + 1), 0.5*sigma*(2 * dt*x[22] * sin(x[52]) + 2 * dt*x[32] * cos(x[52])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[22] * cos(x[52]) - 2 * dt*x[32] * sin(x[52])), 0.5*sigma*(-2 * dt*x[22] * cos(x[52]) + 2 * dt*x[32] * sin(x[52])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[13] * cos(x[52]) - dt * mu[3] * sin(x[52]) + 0.5*sigma*(-2 * dt*(dt*x[22] * sin(x[52]) + dt * x[32] * cos(x[52]))*cos(x[52]) - 2 * dt*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]))*sin(x[52]) - 2 * dt*(-dt * x[22] * sin(x[52]) - dt * x[32] * cos(x[52]) - x[12] + x[13])*cos(x[52]) + 2 * dt*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]) - x[2] + x[3])*sin(x[52])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[13] * sin(x[52]) - dt * mu[3] * cos(x[52]) + 0.5*sigma*(2 * dt*(dt*x[22] * sin(x[52]) + dt * x[32] * cos(x[52]))*sin(x[52]) - 2 * dt*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]))*cos(x[52]) + 2 * dt*(-dt * x[22] * sin(x[52]) - dt * x[32] * cos(x[52]) - x[12] + x[13])*sin(x[52]) + 2 * dt*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]) - x[2] + x[3])*cos(x[52])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[13] * (dt*x[22] * sin(x[52]) + dt * x[32] * cos(x[52])) - mu[3] * (dt*x[22] * cos(x[52]) - dt * x[32] * sin(x[52])) + 0.5*sigma*((dt*x[22] * sin(x[52]) + dt * x[32] * cos(x[52]))*(2 * dt*x[22] * sin(x[52]) + 2 * dt*x[32] * cos(x[52])) + (2 * dt*x[22] * sin(x[52]) + 2 * dt*x[32] * cos(x[52]))*(-dt * x[22] * sin(x[52]) - dt * x[32] * cos(x[52]) - x[12] + x[13]) + (-2 * dt*x[22] * cos(x[52]) + 2 * dt*x[32] * sin(x[52]))*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52])) + (2 * dt*x[22] * cos(x[52]) - 2 * dt*x[32] * sin(x[52]))*(-dt * x[22] * cos(x[52]) + dt * x[32] * sin(x[52]) - x[2] + x[3]) + 4) + 2 * w_ep, 0, 0, 0, 0.5*sigma*(-2 * dt*x[23] * sin(x[53]) - 2 * dt*x[33] * cos(x[53])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[3] + 3 * p3*x[3], 2) + 1), 0.5*sigma*(2 * dt*x[23] * sin(x[53]) + 2 * dt*x[33] * cos(x[53])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[23] * cos(x[53]) - 2 * dt*x[33] * sin(x[53])), 0.5*sigma*(-2 * dt*x[23] * cos(x[53]) + 2 * dt*x[33] * sin(x[53])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[14] * cos(x[53]) - dt * mu[4] * sin(x[53]) + 0.5*sigma*(-2 * dt*(dt*x[23] * sin(x[53]) + dt * x[33] * cos(x[53]))*cos(x[53]) - 2 * dt*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]))*sin(x[53]) - 2 * dt*(-dt * x[23] * sin(x[53]) - dt * x[33] * cos(x[53]) - x[13] + x[14])*cos(x[53]) + 2 * dt*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]) - x[3] + x[4])*sin(x[53])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[14] * sin(x[53]) - dt * mu[4] * cos(x[53]) + 0.5*sigma*(2 * dt*(dt*x[23] * sin(x[53]) + dt * x[33] * cos(x[53]))*sin(x[53]) - 2 * dt*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]))*cos(x[53]) + 2 * dt*(-dt * x[23] * sin(x[53]) - dt * x[33] * cos(x[53]) - x[13] + x[14])*sin(x[53]) + 2 * dt*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]) - x[3] + x[4])*cos(x[53])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[14] * (dt*x[23] * sin(x[53]) + dt * x[33] * cos(x[53])) - mu[4] * (dt*x[23] * cos(x[53]) - dt * x[33] * sin(x[53])) + 0.5*sigma*((dt*x[23] * sin(x[53]) + dt * x[33] * cos(x[53]))*(2 * dt*x[23] * sin(x[53]) + 2 * dt*x[33] * cos(x[53])) + (2 * dt*x[23] * sin(x[53]) + 2 * dt*x[33] * cos(x[53]))*(-dt * x[23] * sin(x[53]) - dt * x[33] * cos(x[53]) - x[13] + x[14]) + (-2 * dt*x[23] * cos(x[53]) + 2 * dt*x[33] * sin(x[53]))*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53])) + (2 * dt*x[23] * cos(x[53]) - 2 * dt*x[33] * sin(x[53]))*(-dt * x[23] * cos(x[53]) + dt * x[33] * sin(x[53]) - x[3] + x[4]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*x[24] * sin(x[54]) - 2 * dt*x[34] * cos(x[54])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[4] + 3 * p3*x[4], 2) + 1), 0.5*sigma*(2 * dt*x[24] * sin(x[54]) + 2 * dt*x[34] * cos(x[54])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[24] * cos(x[54]) - 2 * dt*x[34] * sin(x[54])), 0.5*sigma*(-2 * dt*x[24] * cos(x[54]) + 2 * dt*x[34] * sin(x[54])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[15] * cos(x[54]) - dt * mu[5] * sin(x[54]) + 0.5*sigma*(-2 * dt*(dt*x[24] * sin(x[54]) + dt * x[34] * cos(x[54]))*cos(x[54]) - 2 * dt*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]))*sin(x[54]) - 2 * dt*(-dt * x[24] * sin(x[54]) - dt * x[34] * cos(x[54]) - x[14] + x[15])*cos(x[54]) + 2 * dt*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]) - x[4] + x[5])*sin(x[54])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[15] * sin(x[54]) - dt * mu[5] * cos(x[54]) + 0.5*sigma*(2 * dt*(dt*x[24] * sin(x[54]) + dt * x[34] * cos(x[54]))*sin(x[54]) - 2 * dt*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]))*cos(x[54]) + 2 * dt*(-dt * x[24] * sin(x[54]) - dt * x[34] * cos(x[54]) - x[14] + x[15])*sin(x[54]) + 2 * dt*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]) - x[4] + x[5])*cos(x[54])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[15] * (dt*x[24] * sin(x[54]) + dt * x[34] * cos(x[54])) - mu[5] * (dt*x[24] * cos(x[54]) - dt * x[34] * sin(x[54])) + 0.5*sigma*((dt*x[24] * sin(x[54]) + dt * x[34] * cos(x[54]))*(2 * dt*x[24] * sin(x[54]) + 2 * dt*x[34] * cos(x[54])) + (2 * dt*x[24] * sin(x[54]) + 2 * dt*x[34] * cos(x[54]))*(-dt * x[24] * sin(x[54]) - dt * x[34] * cos(x[54]) - x[14] + x[15]) + (-2 * dt*x[24] * cos(x[54]) + 2 * dt*x[34] * sin(x[54]))*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54])) + (2 * dt*x[24] * cos(x[54]) - 2 * dt*x[34] * sin(x[54]))*(-dt * x[24] * cos(x[54]) + dt * x[34] * sin(x[54]) - x[4] + x[5]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*x[25] * sin(x[55]) - 2 * dt*x[35] * cos(x[55])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[5] + 3 * p3*x[5], 2) + 1), 0.5*sigma*(2 * dt*x[25] * sin(x[55]) + 2 * dt*x[35] * cos(x[55])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[25] * cos(x[55]) - 2 * dt*x[35] * sin(x[55])), 0.5*sigma*(-2 * dt*x[25] * cos(x[55]) + 2 * dt*x[35] * sin(x[55])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[16] * cos(x[55]) - dt * mu[6] * sin(x[55]) + 0.5*sigma*(-2 * dt*(dt*x[25] * sin(x[55]) + dt * x[35] * cos(x[55]))*cos(x[55]) - 2 * dt*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]))*sin(x[55]) - 2 * dt*(-dt * x[25] * sin(x[55]) - dt * x[35] * cos(x[55]) - x[15] + x[16])*cos(x[55]) + 2 * dt*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]) - x[5] + x[6])*sin(x[55])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[16] * sin(x[55]) - dt * mu[6] * cos(x[55]) + 0.5*sigma*(2 * dt*(dt*x[25] * sin(x[55]) + dt * x[35] * cos(x[55]))*sin(x[55]) - 2 * dt*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]))*cos(x[55]) + 2 * dt*(-dt * x[25] * sin(x[55]) - dt * x[35] * cos(x[55]) - x[15] + x[16])*sin(x[55]) + 2 * dt*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]) - x[5] + x[6])*cos(x[55])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[16] * (dt*x[25] * sin(x[55]) + dt * x[35] * cos(x[55])) - mu[6] * (dt*x[25] * cos(x[55]) - dt * x[35] * sin(x[55])) + 0.5*sigma*((dt*x[25] * sin(x[55]) + dt * x[35] * cos(x[55]))*(2 * dt*x[25] * sin(x[55]) + 2 * dt*x[35] * cos(x[55])) + (2 * dt*x[25] * sin(x[55]) + 2 * dt*x[35] * cos(x[55]))*(-dt * x[25] * sin(x[55]) - dt * x[35] * cos(x[55]) - x[15] + x[16]) + (-2 * dt*x[25] * cos(x[55]) + 2 * dt*x[35] * sin(x[55]))*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55])) + (2 * dt*x[25] * cos(x[55]) - 2 * dt*x[35] * sin(x[55]))*(-dt * x[25] * cos(x[55]) + dt * x[35] * sin(x[55]) - x[5] + x[6]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*x[26] * sin(x[56]) - 2 * dt*x[36] * cos(x[56])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[6] + 3 * p3*x[6], 2) + 1), 0.5*sigma*(2 * dt*x[26] * sin(x[56]) + 2 * dt*x[36] * cos(x[56])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[26] * cos(x[56]) - 2 * dt*x[36] * sin(x[56])), 0.5*sigma*(-2 * dt*x[26] * cos(x[56]) + 2 * dt*x[36] * sin(x[56])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[17] * cos(x[56]) - dt * mu[7] * sin(x[56]) + 0.5*sigma*(-2 * dt*(dt*x[26] * sin(x[56]) + dt * x[36] * cos(x[56]))*cos(x[56]) - 2 * dt*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]))*sin(x[56]) - 2 * dt*(-dt * x[26] * sin(x[56]) - dt * x[36] * cos(x[56]) - x[16] + x[17])*cos(x[56]) + 2 * dt*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]) - x[6] + x[7])*sin(x[56])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[17] * sin(x[56]) - dt * mu[7] * cos(x[56]) + 0.5*sigma*(2 * dt*(dt*x[26] * sin(x[56]) + dt * x[36] * cos(x[56]))*sin(x[56]) - 2 * dt*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]))*cos(x[56]) + 2 * dt*(-dt * x[26] * sin(x[56]) - dt * x[36] * cos(x[56]) - x[16] + x[17])*sin(x[56]) + 2 * dt*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]) - x[6] + x[7])*cos(x[56])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[17] * (dt*x[26] * sin(x[56]) + dt * x[36] * cos(x[56])) - mu[7] * (dt*x[26] * cos(x[56]) - dt * x[36] * sin(x[56])) + 0.5*sigma*((dt*x[26] * sin(x[56]) + dt * x[36] * cos(x[56]))*(2 * dt*x[26] * sin(x[56]) + 2 * dt*x[36] * cos(x[56])) + (2 * dt*x[26] * sin(x[56]) + 2 * dt*x[36] * cos(x[56]))*(-dt * x[26] * sin(x[56]) - dt * x[36] * cos(x[56]) - x[16] + x[17]) + (-2 * dt*x[26] * cos(x[56]) + 2 * dt*x[36] * sin(x[56]))*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56])) + (2 * dt*x[26] * cos(x[56]) - 2 * dt*x[36] * sin(x[56]))*(-dt * x[26] * cos(x[56]) + dt * x[36] * sin(x[56]) - x[6] + x[7]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*x[27] * sin(x[57]) - 2 * dt*x[37] * cos(x[57])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[7] + 3 * p3*x[7], 2) + 1), 0.5*sigma*(2 * dt*x[27] * sin(x[57]) + 2 * dt*x[37] * cos(x[57])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[27] * cos(x[57]) - 2 * dt*x[37] * sin(x[57])), 0.5*sigma*(-2 * dt*x[27] * cos(x[57]) + 2 * dt*x[37] * sin(x[57])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[18] * cos(x[57]) - dt * mu[8] * sin(x[57]) + 0.5*sigma*(-2 * dt*(dt*x[27] * sin(x[57]) + dt * x[37] * cos(x[57]))*cos(x[57]) - 2 * dt*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]))*sin(x[57]) - 2 * dt*(-dt * x[27] * sin(x[57]) - dt * x[37] * cos(x[57]) - x[17] + x[18])*cos(x[57]) + 2 * dt*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]) - x[7] + x[8])*sin(x[57])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[18] * sin(x[57]) - dt * mu[8] * cos(x[57]) + 0.5*sigma*(2 * dt*(dt*x[27] * sin(x[57]) + dt * x[37] * cos(x[57]))*sin(x[57]) - 2 * dt*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]))*cos(x[57]) + 2 * dt*(-dt * x[27] * sin(x[57]) - dt * x[37] * cos(x[57]) - x[17] + x[18])*sin(x[57]) + 2 * dt*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]) - x[7] + x[8])*cos(x[57])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[18] * (dt*x[27] * sin(x[57]) + dt * x[37] * cos(x[57])) - mu[8] * (dt*x[27] * cos(x[57]) - dt * x[37] * sin(x[57])) + 0.5*sigma*((dt*x[27] * sin(x[57]) + dt * x[37] * cos(x[57]))*(2 * dt*x[27] * sin(x[57]) + 2 * dt*x[37] * cos(x[57])) + (2 * dt*x[27] * sin(x[57]) + 2 * dt*x[37] * cos(x[57]))*(-dt * x[27] * sin(x[57]) - dt * x[37] * cos(x[57]) - x[17] + x[18]) + (-2 * dt*x[27] * cos(x[57]) + 2 * dt*x[37] * sin(x[57]))*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57])) + (2 * dt*x[27] * cos(x[57]) - 2 * dt*x[37] * sin(x[57]))*(-dt * x[27] * cos(x[57]) + dt * x[37] * sin(x[57]) - x[7] + x[8]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * dt*x[28] * sin(x[58]) - 2 * dt*x[38] * cos(x[58])) - 2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[8] + 3 * p3*x[8], 2) + 1), 0.5*sigma*(2 * dt*x[28] * sin(x[58]) + 2 * dt*x[38] * cos(x[58])), 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(2 * dt*x[28] * cos(x[58]) - 2 * dt*x[38] * sin(x[58])), 0.5*sigma*(-2 * dt*x[28] * cos(x[58]) + 2 * dt*x[38] * sin(x[58])), 0, 0, 0, 0, 0, 0, 0, 0, dt*mu[19] * cos(x[58]) - dt * mu[9] * sin(x[58]) + 0.5*sigma*(-2 * dt*(dt*x[28] * sin(x[58]) + dt * x[38] * cos(x[58]))*cos(x[58]) - 2 * dt*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]))*sin(x[58]) - 2 * dt*(-dt * x[28] * sin(x[58]) - dt * x[38] * cos(x[58]) - x[18] + x[19])*cos(x[58]) + 2 * dt*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]) - x[8] + x[9])*sin(x[58])), 0, 0, 0, 0, 0, 0, 0, 0, 0, -dt * mu[19] * sin(x[58]) - dt * mu[9] * cos(x[58]) + 0.5*sigma*(2 * dt*(dt*x[28] * sin(x[58]) + dt * x[38] * cos(x[58]))*sin(x[58]) - 2 * dt*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]))*cos(x[58]) + 2 * dt*(-dt * x[28] * sin(x[58]) - dt * x[38] * cos(x[58]) - x[18] + x[19])*sin(x[58]) + 2 * dt*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]) - x[8] + x[9])*cos(x[58])), 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, -mu[19] * (dt*x[28] * sin(x[58]) + dt * x[38] * cos(x[58])) - mu[9] * (dt*x[28] * cos(x[58]) - dt * x[38] * sin(x[58])) + 0.5*sigma*((dt*x[28] * sin(x[58]) + dt * x[38] * cos(x[58]))*(2 * dt*x[28] * sin(x[58]) + 2 * dt*x[38] * cos(x[58])) + (2 * dt*x[28] * sin(x[58]) + 2 * dt*x[38] * cos(x[58]))*(-dt * x[28] * sin(x[58]) - dt * x[38] * cos(x[58]) - x[18] + x[19]) + (-2 * dt*x[28] * cos(x[58]) + 2 * dt*x[38] * sin(x[58]))*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58])) + (2 * dt*x[28] * cos(x[58]) - 2 * dt*x[38] * sin(x[58]))*(-dt * x[28] * cos(x[58]) + dt * x[38] * sin(x[58]) - x[8] + x[9]) + 4) + 2 * w_ep, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ep*(2 * p2 + 3 * p3) / (pow(p1 + 2 * p2*x[9] + 3 * p3*x[9], 2) + 1), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1.0*sigma, 1.0*sigma + 2 * w_ep, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[40] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[20], 2))) - x[30] * (-2 * Caf - 2 * Car) / (m*pow(x[20], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[30] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[20], 2)) - x[40] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[20], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[20]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[20])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[20] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[20])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[20])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 2 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[0] - sigma * (s_max - x[60]))*max(0.0, lam[0] - sigma * (s_max - x[60])) + 2 * pow(sigma, 2) * 0 * (lam[9] - sigma * (-s_min + x[60]))*max(0.0, lam[9] - sigma * (-s_min + x[60])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[0] - sigma * (s_max - x[60])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[9] - sigma * (-s_min + x[60])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[41] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[21], 2))) - x[31] * (-2 * Caf - 2 * Car) / (m*pow(x[21], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[31] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[21], 2)) - x[41] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[21], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[21]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[21])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[21] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[21])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[21])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[1] - sigma * (s_max - x[61]))*max(0.0, lam[1] - sigma * (s_max - x[61])) + 2 * pow(sigma, 2) * 0 * (lam[10] - sigma * (-s_min + x[61]))*max(0.0, lam[10] - sigma * (-s_min + x[61])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[1] - sigma * (s_max - x[61])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[10] - sigma * (-s_min + x[61])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[42] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[22], 2))) - x[32] * (-2 * Caf - 2 * Car) / (m*pow(x[22], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[32] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[22], 2)) - x[42] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[22], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[22]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[22])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[22] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[22])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[22])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[11] - sigma * (-s_min + x[62]))*max(0.0, lam[11] - sigma * (-s_min + x[62])) + 2 * pow(sigma, 2) * 0 * (lam[2] - sigma * (s_max - x[62]))*max(0.0, lam[2] - sigma * (s_max - x[62])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[11] - sigma * (-s_min + x[62])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[2] - sigma * (s_max - x[62])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[43] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[23], 2))) - x[33] * (-2 * Caf - 2 * Car) / (m*pow(x[23], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[33] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[23], 2)) - x[43] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[23], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[23]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[23])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[23] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[23])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[23])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[12] - sigma * (-s_min + x[63]))*max(0.0, lam[12] - sigma * (-s_min + x[63])) + 2 * pow(sigma, 2) * 0 * (lam[3] - sigma * (s_max - x[63]))*max(0.0, lam[3] - sigma * (s_max - x[63])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[12] - sigma * (-s_min + x[63])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[3] - sigma * (s_max - x[63])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[44] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[24], 2))) - x[34] * (-2 * Caf - 2 * Car) / (m*pow(x[24], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[34] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[24], 2)) - x[44] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[24], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[24]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[24])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[24] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[24])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[24])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[13] - sigma * (-s_min + x[64]))*max(0.0, lam[13] - sigma * (-s_min + x[64])) + 2 * pow(sigma, 2) * 0 * (lam[4] - sigma * (s_max - x[64]))*max(0.0, lam[4] - sigma * (s_max - x[64])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[13] - sigma * (-s_min + x[64])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[4] - sigma * (s_max - x[64])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[45] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[25], 2))) - x[35] * (-2 * Caf - 2 * Car) / (m*pow(x[25], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[35] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[25], 2)) - x[45] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[25], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[25]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[25])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[25] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[25])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[25])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[14] - sigma * (-s_min + x[65]))*max(0.0, lam[14] - sigma * (-s_min + x[65])) + 2 * pow(sigma, 2) * 0 * (lam[5] - sigma * (s_max - x[65]))*max(0.0, lam[5] - sigma * (s_max - x[65])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[14] - sigma * (-s_min + x[65])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[5] - sigma * (s_max - x[65])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[46] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[26], 2))) - x[36] * (-2 * Caf - 2 * Car) / (m*pow(x[26], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[36] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[26], 2)) - x[46] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[26], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[26]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[26])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[26] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[26])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[26])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[15] - sigma * (-s_min + x[66]))*max(0.0, lam[15] - sigma * (-s_min + x[66])) + 2 * pow(sigma, 2) * 0 * (lam[6] - sigma * (s_max - x[66]))*max(0.0, lam[6] - sigma * (s_max - x[66])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[15] - sigma * (-s_min + x[66])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[6] - sigma * (s_max - x[66])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[47] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[27], 2))) - x[37] * (-2 * Caf - 2 * Car) / (m*pow(x[27], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[37] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[27], 2)) - x[47] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[27], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[27]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[27])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[27] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[27])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[27])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 4 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[16] - sigma * (-s_min + x[67]))*max(0.0, lam[16] - sigma * (-s_min + x[67])) + 2 * pow(sigma, 2) * 0 * (lam[7] - sigma * (s_max - x[67]))*max(0.0, lam[7] - sigma * (s_max - x[67])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[16] - sigma * (-s_min + x[67])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[7] - sigma * (s_max - x[67])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(x[48] * (-1 - (-2 * Caf*Lf + 2 * Car*Lr) / (m*pow(x[28], 2))) - x[38] * (-2 * Caf - 2 * Car) / (m*pow(x[28], 2))) / m + 4 * Caf*Lf*pow(dt, 2)*(-x[38] * (-2 * Caf*Lf + 2 * Car*Lr) / (I*pow(x[28], 2)) - x[48] * (-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*pow(x[28], 2))) / I), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(-2 * Caf*dt*(-2 * dt*(-2 * Caf - 2 * Car) / (m*x[28]) - 2) / m + 4 * Caf*Lf*pow(dt, 2)*(-2 * Caf*Lf + 2 * Car*Lr) / (pow(I, 2)*x[28])), -2.0*Caf*dt*sigma / m, 0, 0, 0, 0, 0, 0, 0, 0, 0.5*sigma*(4 * Caf*pow(dt, 2)*(-x[28] + (-2 * Caf*Lf + 2 * Car*Lr) / (m*x[28])) / m - 2 * Caf*Lf*dt*(-2 - 2 * dt*(-2 * Caf*pow(Lf, 2) - 2 * Car*pow(Lr, 2)) / (I*x[28])) / I), -2.0*Caf*Lf*dt*sigma / I, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_sd, 0.5*sigma*(8 * pow(Caf, 2)*pow(dt, 2) / pow(m, 2) + 8 * pow(Caf, 2)*pow(Lf, 2)*pow(dt, 2) / pow(I, 2)) + 2 * w_s + 2 * w_sd + 0.5*(2 * pow(sigma, 2) * 0 * (lam[17] - sigma * (-s_min + x[68]))*max(0.0, lam[17] - sigma * (-s_min + x[68])) + 2 * pow(sigma, 2) * 0 * (lam[8] - sigma * (s_max - x[68]))*max(0.0, lam[8] - sigma * (s_max - x[68])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[17] - sigma * (-s_min + x[68])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[8] - sigma * (s_max - x[68])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*pow(dt, 2)*sigma + 2 * w_a + 2 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[18] - sigma * (a_max - x[69]))*max(0.0, lam[18] - sigma * (a_max - x[69])) + 2 * pow(sigma, 2) * 0 * (lam[27] - sigma * (-a_min + x[69]))*max(0.0, lam[27] - sigma * (-a_min + x[69])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[18] - sigma * (a_max - x[69])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[27] - sigma * (-a_min + x[69])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[19] - sigma * (a_max - x[70]))*max(0.0, lam[19] - sigma * (a_max - x[70])) + 2 * pow(sigma, 2) * 0 * (lam[28] - sigma * (-a_min + x[70]))*max(0.0, lam[28] - sigma * (-a_min + x[70])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[19] - sigma * (a_max - x[70])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[28] - sigma * (-a_min + x[70])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[20] - sigma * (a_max - x[71]))*max(0.0, lam[20] - sigma * (a_max - x[71])) + 2 * pow(sigma, 2) * 0 * (lam[29] - sigma * (-a_min + x[71]))*max(0.0, lam[29] - sigma * (-a_min + x[71])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[20] - sigma * (a_max - x[71])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[29] - sigma * (-a_min + x[71])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[21] - sigma * (a_max - x[72]))*max(0.0, lam[21] - sigma * (a_max - x[72])) + 2 * pow(sigma, 2) * 0 * (lam[30] - sigma * (-a_min + x[72]))*max(0.0, lam[30] - sigma * (-a_min + x[72])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[21] - sigma * (a_max - x[72])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[30] - sigma * (-a_min + x[72])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[22] - sigma * (a_max - x[73]))*max(0.0, lam[22] - sigma * (a_max - x[73])) + 2 * pow(sigma, 2) * 0 * (lam[31] - sigma * (-a_min + x[73]))*max(0.0, lam[31] - sigma * (-a_min + x[73])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[22] - sigma * (a_max - x[73])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[31] - sigma * (-a_min + x[73])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[23] - sigma * (a_max - x[74]))*max(0.0, lam[23] - sigma * (a_max - x[74])) + 2 * pow(sigma, 2) * 0 * (lam[32] - sigma * (-a_min + x[74]))*max(0.0, lam[32] - sigma * (-a_min + x[74])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[23] - sigma * (a_max - x[74])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[32] - sigma * (-a_min + x[74])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[24] - sigma * (a_max - x[75]))*max(0.0, lam[24] - sigma * (a_max - x[75])) + 2 * pow(sigma, 2) * 0 * (lam[33] - sigma * (-a_min + x[75]))*max(0.0, lam[33] - sigma * (-a_min + x[75])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[24] - sigma * (a_max - x[75])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[33] - sigma * (-a_min + x[75])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 4 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[25] - sigma * (a_max - x[76]))*max(0.0, lam[25] - sigma * (a_max - x[76])) + 2 * pow(sigma, 2) * 0 * (lam[34] - sigma * (-a_min + x[76]))*max(0.0, lam[34] - sigma * (-a_min + x[76])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[25] - sigma * (a_max - x[76])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[34] - sigma * (-a_min + x[76])), 2)) / sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1.0*dt*sigma, -1.0*dt*sigma, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2 * w_ad, 1.0*pow(dt, 2)*sigma + 2 * w_a + 2 * w_ad + 0.5*(2 * pow(sigma, 2) * 0 * (lam[26] - sigma * (a_max - x[77]))*max(0.0, lam[26] - sigma * (a_max - x[77])) + 2 * pow(sigma, 2) * 0 * (lam[35] - sigma * (-a_min + x[77]))*max(0.0, lam[35] - sigma * (-a_min + x[77])) + 2 * pow(sigma, 2)*pow(Heaviside(lam[26] - sigma * (a_max - x[77])), 2) + 2 * pow(sigma, 2)*pow(Heaviside(lam[35] - sigma * (-a_min + x[77])), 2)) / sigma };

			size_t idx = 0;
			for (int i = 0;i < 78;++i)
				for (int j = 0; j < (i + 1);++j)
				{
					hpsi(i, j) = buf[idx++];
					hpsi(j, i) = hpsi(i, j);
				}
		}
	};
}


void test1()
{
	SISS::LDM ldm;
	int iters = 1;
	double cost;
	auto begin = std::chrono::steady_clock::now();

	for (size_t i = 0; i < iters; i++)
	{
		for (int j = 0;j < ldm.settings.N; j++)
		{
			ldm.m_x[2 * ldm.settings.N + j] = 10.0;
		}
		cout << "x = " << ldm.m_x.transpose() << endl;
		cost = multphr<SISS::LDM>(std::make_shared<SISS::LDM>(ldm), ldm.m_x);
	}
	auto end = std::chrono::steady_clock::now();

	std::cout << "Average Time difference = "
		<< std::chrono::duration_cast<std::chrono::microseconds>(end -
			begin)
		.count() /
		1000. / (float)iters
		<< "ms \n";

	cout << "cost = " << cost << endl;
	cout << "x = " << ldm.m_x.transpose() << endl;
}

void test2()
{
	SISS::LDM ldm;
	int iters = 1;
	double cost;
	auto begin = std::chrono::steady_clock::now();

	for (size_t i = 0; i < iters; i++)
	{
		for (int j = 0;j < ldm.settings.N; j++)
		{
			ldm.m_x[2 * ldm.settings.N + j] = 10.0;
		}
		cout << "x = " << ldm.m_x.transpose() << endl;
		cost = SISS::multphr_hess<SISS::LDM>(std::make_shared<SISS::LDM>(ldm), ldm.m_x);
		//cost = multphr<SISS::LDM>(std::make_shared<SISS::LDM>(ldm), ldm.m_x);
	}
	auto end = std::chrono::steady_clock::now();

	std::cout << "Average Time difference = "
		<< std::chrono::duration_cast<std::chrono::microseconds>(end -
			begin)
		.count() /
		1000. / (float)iters
		<< "ms \n";

	cout << "cost = " << cost << endl;
	cout << "x = " << ldm.m_x.transpose() << endl;
}

void test3()
{
	SISS::LDM ldm;
	int iters = 1;
	double cost;
	auto begin = std::chrono::steady_clock::now();

	for (size_t i = 0; i < iters; i++)
	{
		for (int j = 0;j < ldm.settings.N; j++)
		{
			ldm.m_x[2 * ldm.settings.N + j] = 10.0;
		}
		cout << "x = " << ldm.m_x.transpose() << endl;
		cost = multphr_Hess<SISS::LDM>(std::make_shared<SISS::LDM>(ldm), ldm.m_x);
	}
	auto end = std::chrono::steady_clock::now();

	std::cout << "Average Time difference = "
		<< std::chrono::duration_cast<std::chrono::microseconds>(end -
			begin)
		.count() /
		1000. / (float)iters
		<< "ms \n";

	cout << "cost = " << cost << endl;
	cout << "x = " << ldm.m_x.transpose() << endl;
}
int main()
{
	test3();
	test2();
	test1();
	std::getchar();

	return 0;
}